-- 코드를 입력하세요
# MySQL 버전
# 가격을 10000으로 나누어 몫이 같은 것끼리 GROUP BY
# (0 ~ 9999 = 0, 10000 ~ 19999 = 1, ...., 90000 ~ 99999 = 9) * 10000 해주어 컬럼명 0, 10000,..., 90000원대로 설정
SELECT (PRICE DIV 10000) * 10000 AS PRICE_GROUP, COUNT(*)
FROM PRODUCT
GROUP BY (PRICE DIV 10000) * 10000
ORDER BY 1;

# Oracle 버전
SELECT TRUNCATE(PRICE / 10000, 0) * 10000 AS PRICE_GROUP, COUNT(PRODUCT_ID) AS PRODUCTS
FROM PRODUCT
GROUP BY PRICE_GROUP
ORDER BY PRICE_GROUP;

# 두 가지 버전 다 가능
# GROUP BY 2번 사용
SELECT PRICE_GROUP, SUM(PRODUCTS) AS PRODUCTS
FROM (SELECT CASE
            WHEN PRICE >= 0 AND PRICE < 10000 THEN 0
            WHEN PRICE >= 10000 AND PRICE < 20000 THEN 10000
            WHEN PRICE >= 20000 AND PRICE < 30000 THEN 20000
            WHEN PRICE >= 30000 AND PRICE < 40000 THEN 30000
            WHEN PRICE >= 40000 AND PRICE < 50000 THEN 40000
            WHEN PRICE >= 50000 AND PRICE < 60000 THEN 50000
            WHEN PRICE >= 60000 AND PRICE < 70000 THEN 60000
            WHEN PRICE >= 70000 AND PRICE < 80000 THEN 70000
            WHEN PRICE >= 80000 AND PRICE < 90000 THEN 80000
        END AS PRICE_GROUP, COUNT(PRODUCT_ID) AS PRODUCTS
FROM PRODUCT 
GROUP BY PRICE) AS nt
GROUP BY PRICE_GROUP
ORDER BY 1;

# SELECT, GROUP BY절에 CASE문 그대로 사용
SELECT CASE
            WHEN PRICE >= 0 AND PRICE < 10000 THEN 0
            WHEN PRICE >= 10000 AND PRICE < 20000 THEN 10000
            WHEN PRICE >= 20000 AND PRICE < 30000 THEN 20000
            WHEN PRICE >= 30000 AND PRICE < 40000 THEN 30000
            WHEN PRICE >= 40000 AND PRICE < 50000 THEN 40000
            WHEN PRICE >= 50000 AND PRICE < 60000 THEN 50000
            WHEN PRICE >= 60000 AND PRICE < 70000 THEN 60000
            WHEN PRICE >= 70000 AND PRICE < 80000 THEN 70000
            WHEN PRICE >= 80000 AND PRICE < 90000 THEN 80000
        END AS PRICE_GROUP, COUNT(PRODUCT_CODE) AS PRODUCTS
FROM PRODUCT
GROUP BY CASE
            WHEN PRICE >= 0 AND PRICE < 10000 THEN 0
            WHEN PRICE >= 10000 AND PRICE < 20000 THEN 10000
            WHEN PRICE >= 20000 AND PRICE < 30000 THEN 20000
            WHEN PRICE >= 30000 AND PRICE < 40000 THEN 30000
            WHEN PRICE >= 40000 AND PRICE < 50000 THEN 40000
            WHEN PRICE >= 50000 AND PRICE < 60000 THEN 50000
            WHEN PRICE >= 60000 AND PRICE < 70000 THEN 60000
            WHEN PRICE >= 70000 AND PRICE < 80000 THEN 70000
            WHEN PRICE >= 80000 AND PRICE < 90000 THEN 80000
        END
ORDER BY PRICE_GROUP;

# CASE문을 인라인뷰로 사용
SELECT nt.PRICE_GROUP, COUNT(*) AS PRODUCTS
FROM (SELECT CASE
            WHEN PRICE >= 0 AND PRICE < 10000 THEN 0
            WHEN PRICE >= 10000 AND PRICE < 20000 THEN 10000
            WHEN PRICE >= 20000 AND PRICE < 30000 THEN 20000
            WHEN PRICE >= 30000 AND PRICE < 40000 THEN 30000
            WHEN PRICE >= 40000 AND PRICE < 50000 THEN 40000
            WHEN PRICE >= 50000 AND PRICE < 60000 THEN 50000
            WHEN PRICE >= 60000 AND PRICE < 70000 THEN 60000
            WHEN PRICE >= 70000 AND PRICE < 80000 THEN 70000
            WHEN PRICE >= 80000 AND PRICE < 90000 THEN 80000
        END AS PRICE_GROUP
FROM PRODUCT) AS nt
GROUP BY nt.PRICE_GROUP
ORDER BY 1;
